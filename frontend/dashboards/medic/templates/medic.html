{% extends 'templates/base.html' %}

{% block title %}MÃ©dico - {{ title if title is defined else 'MÃ©dico' }}{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{{ url_for('static', path='dashboards/medic/css/medic.css') }}" />
{% endblock %}

{% block content %}
  <div class="role-header">
    <div class="role-emoji">ðŸ©º</div>
    <div>
      <div class="role-title">Panel MÃ©dico <span class="badge" data-tooltip="Ãrea clÃ­nica">MÃ©dico</span></div>
      <div class="lead">Resumen clÃ­nico y prÃ³ximas citas.</div>
    </div>
  </div>

  <section class="cards">
    <div class="card">
      <h3>ðŸ‘¥ Pacientes asignados</h3>
      <p class="metric" data-field="metrics.assigned" id="assigned-count">{{ metrics.assigned if metrics and metrics.assigned is defined else 'â€”' }}</p>
    </div>
    <div class="card">
      <h3>ðŸ“… Citas admitidas hoy</h3>
      <p class="metric" data-field="metrics.appointments_today" id="appointments-count">{{ metrics.appointments_today if metrics and metrics.appointments_today is defined else 'â€”' }}</p>
      <button onclick="MedicDashboard.loadAppointments()" class="btn-secondary">Ver citas</button>
    </div>
  </section>

  <!-- SecciÃ³n de citas -->
  <section id="appointments-section" style="margin-top: 2rem;">
    <h2>Citas Admitidas</h2>
    <div id="appointments-list"></div>
  </section>

  <!-- SecciÃ³n de detalle de paciente (modal) -->
  <div id="patient-detail-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000;">
    <div style="background:white; margin:5% auto; padding:2rem; width:90%; max-width:600px; border-radius:8px; max-height:80vh; overflow-y:auto;">
      <h3>Detalle del Paciente</h3>
      <div id="patient-detail-content"></div>
      <button onclick="MedicDashboard.hidePatientDetail()" class="btn-secondary" style="margin-top:1rem;">Cerrar</button>
    </div>
  </div>

{% endblock %}

{% block scripts %}
  <script>window.EXPECTED_ROLE = 'medic';</script>
  <script src="{{ url_for('static', path='js/auth.js') }}"></script>
  <script src="{{ url_for('static', path='js/dashboard.js') }}"></script>
  <script src="{{ url_for('static', path='dashboards/medic/js/medic.js') }}"></script>
{% endblock %}
